# Deer-Go å¤šæ™ºèƒ½ä½“ç³»ç»Ÿæ¶æ„æ€»ç»“

## ä¸€ã€ç³»ç»Ÿæ¦‚è§ˆ

Deer-Go æ˜¯ä¸€ä¸ªåŸºäº **Eino æ¡†æ¶**æ„å»ºçš„**å¤šæ™ºèƒ½ä½“ç ”ç©¶ç³»ç»Ÿ**ï¼Œé€šè¿‡å¤šä¸ªä¸“ä¸šåŒ–çš„ Agent ååŒå·¥ä½œï¼Œå°†ç”¨æˆ·çš„ç ”ç©¶éœ€æ±‚è‡ªåŠ¨åˆ†è§£ã€æ‰§è¡Œå¹¶ç”Ÿæˆé«˜è´¨é‡çš„ç ”ç©¶æŠ¥å‘Šã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸ¤– **8 ä¸ªä¸“ä¸šåŒ– Agent**ï¼šå„å¸å…¶èŒï¼Œå½¢æˆå®Œæ•´çš„ç ”ç©¶å·¥ä½œæµ
- ğŸ”„ **åŠ¨æ€è·¯ç”±æœºåˆ¶**ï¼šåŸºäºçŠ¶æ€é©±åŠ¨çš„æ™ºèƒ½æµç¨‹æ§åˆ¶
- ğŸ‘¤ **äººåœ¨å›è·¯**ï¼šæ”¯æŒäººå·¥ä»‹å…¥çš„è´¨é‡æŠŠå…³æœºåˆ¶
- ğŸ’¾ **ä¸­æ–­ä¸æ¢å¤**ï¼šåŸºäº CheckPoint çš„çŠ¶æ€æŒä¹…åŒ–
- ğŸŒ **å¤šè¯­è¨€æ”¯æŒ**ï¼šè‡ªåŠ¨æ£€æµ‹å¹¶é€‚é…ç”¨æˆ·è¯­è¨€
- ğŸ”§ **å·¥å…·é›†æˆ**ï¼šMCP å·¥å…·åŠ¨æ€åŠ è½½ï¼ˆæœç´¢ã€ä»£ç æ‰§è¡Œç­‰ï¼‰

---

## äºŒã€ç³»ç»Ÿæ¶æ„å›¾

### 2.1 æ•´ä½“æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ç”¨æˆ·é—®é¢˜                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Coordinator   â”‚  1ï¸âƒ£ ä»»åŠ¡ç†è§£ & è¯­è¨€æ£€æµ‹
                    â”‚   (åè°ƒå™¨)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Background      â”‚  2ï¸âƒ£ é¢„æœç´¢èƒŒæ™¯ä¿¡æ¯ (å¯é€‰)
                    â”‚ Investigator    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Planner      â”‚  3ï¸âƒ£ åˆ¶å®šç ”ç©¶è®¡åˆ’
                    â”‚   (è§„åˆ’å¸ˆ)       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ has_enough_context? â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                   No                Yes
                    â”‚                 â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
           â”‚     Human       â”‚  4ï¸âƒ£ äººå·¥ç¡®è®¤ (æ¡ä»¶è§¦å‘)
           â”‚  (äººå·¥åé¦ˆ)      â”‚        â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
                    â”‚                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       Edit                Accept
        â”‚                     â”‚
        â†“                     â†“
    [è¿”å›Planner]     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ ResearchTeam   â”‚  5ï¸âƒ£ ä»»åŠ¡è°ƒåº¦
                      â”‚   (è°ƒåº¦å™¨)      â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚ éå† Plan.Steps â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚                         â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Researcher    â”‚  6ï¸âƒ£   â”‚     Coder      â”‚  6ï¸âƒ£
        â”‚  (ç ”ç©¶å‘˜-ReAct) â”‚       â”‚ (ä»£ç æ‰§è¡Œå™¨)    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                         â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚ æ‰€æœ‰æ­¥éª¤å®Œæˆï¼Ÿ   â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                             Yes
                              â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚    Reporter     â”‚  7ï¸âƒ£ ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š
                     â”‚   (æŠ¥å‘Šç”Ÿæˆå™¨)   â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   æœ€ç»ˆæŠ¥å‘Š      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 å­å›¾å±‚æ¬¡ç»“æ„

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Main Graph        â”‚
                    â”‚    (EinoDeer)        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                      â”‚                      â”‚
   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
   â”‚Subgraph â”‚           â”‚Subgraph â”‚           â”‚Subgraph â”‚
   â”‚  (8ä¸ª)   â”‚           â”‚  (8ä¸ª)   â”‚           â”‚  (8ä¸ª)   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ¯ä¸ª Subgraph å†…éƒ¨ç»“æ„ (å¤§éƒ¨åˆ†):
    START â†’ load â†’ agent â†’ router â†’ END
```

---

## ä¸‰ã€å­æ¨¡å—åŠŸèƒ½è¯¦è§£

### 3.1 Builder (å›¾æ„å»ºå™¨)

**èŒè´£**ï¼šç³»ç»Ÿçš„æ€»è£…é…çº¿

**åŠŸèƒ½**ï¼š
- âœ… åˆå§‹åŒ–æ‰€æœ‰ 8 ä¸ªå­å›¾
- âœ… å»ºç«‹åŠ¨æ€è·¯ç”± (`agentHandOff` + `AddBranch`)
- âœ… é…ç½®å…¨å±€çŠ¶æ€ç®¡ç† (`WithGenLocalState`)
- âœ… ç¼–è¯‘å¯æ‰§è¡Œå›¾ (`Compile`)
- âœ… æ”¯æŒå¾ªç¯å›¾ (`WithNodeTriggerMode(AnyPredecessor)`)

**å…³é”®è®¾è®¡**ï¼š
```go
// åŠ¨æ€è·¯ç”±å‡½æ•°ï¼šè¯»å– state.Goto å†³å®šä¸‹ä¸€ä¸ª Agent
func agentHandOff(ctx context.Context, input string) (next string, err error) {
    compose.ProcessState[*model.State](ctx, func(_, state *model.State) error {
        next = state.Goto  // ğŸ‘ˆ çŠ¶æ€é©±åŠ¨è·¯ç”±
        return nil
    })
    return next, nil
}
```

**ç‰¹ç‚¹**ï¼š
- ä¸­å¿ƒåŒ–è·¯ç”±æ¨¡å¼
- æ‰€æœ‰ Agent é€šè¿‡ç»Ÿä¸€çš„ `agentHandOff` è¿æ¥
- æ˜“äºæ‰©å±•ï¼ˆæ–°å¢ Agent åªéœ€ 4 æ­¥ï¼‰

---

### 3.2 Coordinator (åè°ƒå™¨)

**èŒè´£**ï¼šç³»ç»Ÿå…¥å£ï¼Œä»»åŠ¡ç†è§£ä¸è¯­è¨€æ£€æµ‹

**æµç¨‹**ï¼š
```
ç”¨æˆ·é—®é¢˜ â†’ load (æ„é€ Prompt) 
         â†’ agent (LLMåˆ†æ) 
         â†’ router (è§£æå·¥å…·è°ƒç”¨)
```

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
1. **ä»»åŠ¡åˆ†æ**ï¼šåˆ¤æ–­æ˜¯å¦æ˜¯æœ‰æ•ˆçš„ç ”ç©¶ä»»åŠ¡
2. **è¯­è¨€æ£€æµ‹**ï¼šè‡ªåŠ¨è¯†åˆ«ç”¨æˆ·è¯­è¨€ (en-US, zh-CN, etc.)
3. **æµç¨‹å†³ç­–**ï¼š
   - å¯ç”¨èƒŒæ™¯è°ƒæŸ¥ â†’ BackgroundInvestigator
   - ç¦ç”¨èƒŒæ™¯è°ƒæŸ¥ â†’ Planner
   - æ— æ•ˆä»»åŠ¡ â†’ END

**å…³é”®è¾“å‡º**ï¼š
- `state.Locale`ï¼šç”¨æˆ·è¯­è¨€ï¼ˆå…¨å±€ä½¿ç”¨ï¼‰
- `state.Goto`ï¼šä¸‹ä¸€æ­¥è·¯ç”±ç›®æ ‡

**Tool**ï¼š
```go
hand_to_planner({
    "task_title": "ä»»åŠ¡æ ‡é¢˜",
    "locale": "zh-CN"
})
```

---

### 3.3 BackgroundInvestigator (èƒŒæ™¯è°ƒæŸ¥å‘˜)

**èŒè´£**ï¼šé¢„æœç´¢èƒŒæ™¯ä¿¡æ¯ï¼Œå¢å¼º Planner ä¸Šä¸‹æ–‡

**æµç¨‹**ï¼š
```
START â†’ search (æ‰§è¡Œæœç´¢) â†’ router (è¿”å›Planner) â†’ END
```

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
1. **åŠ¨æ€å·¥å…·å‘ç°**ï¼šä» MCP ä¸­æŸ¥æ‰¾åå­—åŒ…å« "search" çš„å·¥å…·
2. **å¿«é€Ÿæœç´¢**ï¼šä½¿ç”¨ç”¨æˆ·åŸå§‹é—®é¢˜è¿›è¡Œæœç´¢
3. **ç»“æœä¿å­˜**ï¼š`state.BackgroundInvestigationResults`

**ç‰¹ç‚¹**ï¼š
- è½»é‡çº§ï¼ˆå•æ¬¡æœç´¢ï¼Œæ— æ·±åº¦æ¨ç†ï¼‰
- å¯é€‰åŠŸèƒ½ï¼ˆåŸºäº `EnableBackgroundInvestigation` é…ç½®ï¼‰
- ä¸º Planner æä¾›æ—¶æ•ˆæ€§ä¿¡æ¯

**vs. Researcher**ï¼š
| ç‰¹æ€§ | BackgroundInvestigator | Researcher |
|------|----------------------|------------|
| æ—¶æœº | Planner **ä¹‹å‰** | Planner **ä¹‹å** |
| æ·±åº¦ | æµ…ï¼ˆå•æ¬¡æœç´¢ï¼‰ | æ·±ï¼ˆå¤šè½® ReActï¼‰ |
| ç›®çš„ | è¾…åŠ©è§„åˆ’ | æ‰§è¡Œå…·ä½“æ­¥éª¤ |

---

### 3.4 Planner (è§„åˆ’å¸ˆ)

**èŒè´£**ï¼šæ ¸å¿ƒå†³ç­– Agentï¼Œå°†ä»»åŠ¡åˆ†è§£ä¸ºå¯æ‰§è¡Œè®¡åˆ’

**æµç¨‹**ï¼š
```
START â†’ load (æ³¨å…¥èƒŒæ™¯ä¿¡æ¯) 
      â†’ agent (ç”ŸæˆPlan-JSON) 
      â†’ router (è§£æ+è·¯ç”±)
      â†’ END
```

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
1. **ä»»åŠ¡åˆ†è§£**ï¼šç”Ÿæˆ `Plan{Title, Thought, Steps[]}`
2. **ä¸Šä¸‹æ–‡è¯„ä¼°**ï¼šåˆ¤æ–­ `has_enough_context`
3. **æ­¥éª¤åˆ†ç±»**ï¼šåŒºåˆ† `research` å’Œ `processing` ç±»å‹
4. **è¿­ä»£æ”¯æŒ**ï¼šè·Ÿè¸ª `PlanIterations`

**å…³é”®æ•°æ®ç»“æ„**ï¼š
```go
type Plan struct {
    Locale           string  // è¯­è¨€
    HasEnoughContext bool    // ğŸ‘ˆ å†³å®šæµç¨‹èµ°å‘
    Thought          string  // æ€è€ƒè¿‡ç¨‹
    Title            string  // ä»»åŠ¡æ ‡é¢˜
    Steps            []Step  // å…·ä½“æ­¥éª¤
}

type Step struct {
    NeedWebSearch bool
    Title         string
    Description   string
    StepType      StepType     // "research" or "processing"
    ExecutionRes  *string      // æ‰§è¡Œç»“æœ (åˆå§‹ nil)
}
```

**è·¯ç”±å†³ç­–**ï¼š
```
has_enough_context = true  â†’ Reporter (è·³è¿‡ Humanï¼Œç›´æ¥æ‰§è¡Œ)
has_enough_context = false â†’ Human (éœ€è¦äººå·¥ç¡®è®¤)
```

---

### 3.5 Human (äººå·¥åé¦ˆèŠ‚ç‚¹)

**èŒè´£**ï¼šäººåœ¨å›è·¯ï¼ˆHuman-in-the-Loopï¼‰ï¼Œè´¨é‡æŠŠå…³

**æµç¨‹**ï¼š
```
START â†’ router (å¤„ç†åé¦ˆ) â†’ END
```

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
1. **æµç¨‹ä¸­æ–­**ï¼š`InterruptAndRerun` æš‚åœæ‰§è¡Œ
2. **ç­‰å¾…åé¦ˆ**ï¼šç”¨æˆ·é€‰æ‹© Accept/Edit
3. **çŠ¶æ€æ¢å¤**ï¼šä» CheckPoint ç»§ç»­æ‰§è¡Œ
4. **è‡ªåŠ¨æ¨¡å¼**ï¼šæ”¯æŒè·³è¿‡äººå·¥ç¡®è®¤

**å·¥ä½œæ¨¡å¼**ï¼š
```go
if state.AutoAcceptedPlan {
    // è‡ªåŠ¨æ¨¡å¼ï¼šç›´æ¥æ‰§è¡Œ
    state.Goto = ResearchTeam
} else {
    // æ‰‹åŠ¨æ¨¡å¼
    switch state.InterruptFeedback {
    case "accepted":
        state.Goto = ResearchTeam  // æ‰§è¡Œ
    case "edit_plan":
        state.Goto = Planner       // é‡æ–°è§„åˆ’
    default:
        return InterruptAndRerun   // ç­‰å¾…ç”¨æˆ·è¾“å…¥
    }
}
```

**åº”ç”¨åœºæ™¯**ï¼š
- âœ… ä»»åŠ¡æ¨¡ç³Šéœ€è¦æ¾„æ¸…
- âœ… æ•æ„Ÿæ“ä½œéœ€è¦æˆæƒ
- âœ… èµ„æºæ¶ˆè€—å¤§éœ€è¦ç¡®è®¤

---

### 3.6 ResearchTeam (ç ”ç©¶å›¢é˜Ÿè°ƒåº¦å™¨)

**èŒè´£**ï¼šä»»åŠ¡è°ƒåº¦ä¸­å¿ƒï¼Œéå†æ­¥éª¤å¹¶åˆ†å‘

**æµç¨‹**ï¼š
```
START â†’ load (å ä½) â†’ router (æŸ¥æ‰¾æœªå®Œæˆæ­¥éª¤) â†’ END
```

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
1. **æ­¥éª¤éå†**ï¼šæŒ‰é¡ºåºæŸ¥æ‰¾ `ExecutionRes == nil` çš„æ­¥éª¤
2. **ç±»å‹è·¯ç”±**ï¼š
   - `step_type = "research"` â†’ Researcher
   - `step_type = "processing"` â†’ Coder
3. **å®Œæˆåˆ¤æ–­**ï¼šæ‰€æœ‰æ­¥éª¤å®Œæˆ â†’ Reporter
4. **è¿­ä»£æ§åˆ¶**ï¼šåŸºäº `PlanIterations` å’Œ `MaxPlanIterations`

**è¿­ä»£æ¨¡å¼**ï¼š
```
ResearchTeam â†’ Researcher â†’ ResearchTeam  â”
            â†˜ Coder â†’ ResearchTeam         â”œâ”€ å¾ªç¯
                      â†“                    â”˜
                (æ‰€æœ‰æ­¥éª¤å®Œæˆ)
                      â†“
                   Reporter
```

**ç‰¹ç‚¹**ï¼š
- çº¯é€»è¾‘è·¯ç”±ï¼ˆæ—  LLM è°ƒç”¨ï¼‰
- ç®€å•é«˜æ•ˆ
- æ”¯æŒä»»æ„æ•°é‡çš„æ­¥éª¤

---

### 3.7 Researcher (ç ”ç©¶å‘˜)

**èŒè´£**ï¼šæ‰§è¡Œ `research` ç±»å‹æ­¥éª¤ï¼Œæ·±åº¦ç ”ç©¶

**æµç¨‹**ï¼š
```
START â†’ load (æ³¨å…¥æ­¥éª¤ä¿¡æ¯) 
      â†’ agent (ReAct Agent + Web Search) 
      â†’ router (ä¿å­˜ç»“æœ)
      â†’ END
```

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
1. **ReAct æ¨ç†**ï¼šå¤šè½®æ€è€ƒ-è¡ŒåŠ¨-è§‚å¯Ÿå¾ªç¯
2. **å·¥å…·ä½¿ç”¨**ï¼šWeb Search, Wikipedia, etc.
3. **ç»“æœä¿å­˜**ï¼š`step.ExecutionRes = LLMçš„æœ€ç»ˆè¾“å‡º`
4. **è¿”å›è°ƒåº¦**ï¼šå®Œæˆåè¿”å› ResearchTeam

**ReAct å¾ªç¯ç¤ºä¾‹**ï¼š
```
Round 1: æ€è€ƒ â†’ è°ƒç”¨ search("AI trends") â†’ è§‚å¯Ÿç»“æœ
Round 2: æ€è€ƒ â†’ è°ƒç”¨ wikipedia("GPT-4") â†’ è§‚å¯Ÿç»“æœ
Round 3: æ€è€ƒ â†’ ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ
```

**å·¥å…·åŠ è½½**ï¼š
```go
// åŠ è½½æ‰€æœ‰åå­—åŒ…å« "search" çš„å·¥å…·
if strings.HasSuffix(info.Name, "search") {
    researchTools = append(researchTools, t)
}
```

---

### 3.8 Coder (ä»£ç æ‰§è¡Œå™¨)

**èŒè´£**ï¼šæ‰§è¡Œ `processing` ç±»å‹æ­¥éª¤ï¼Œä»£ç ç”Ÿæˆä¸è¿è¡Œ

**æµç¨‹**ï¼š
```
START â†’ load (æ³¨å…¥æ­¥éª¤ä¿¡æ¯) 
      â†’ agent (ReAct Agent + Python MCP) 
      â†’ router (ä¿å­˜ç»“æœ)
      â†’ END
```

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
1. **ä»£ç ç”Ÿæˆ**ï¼šæ ¹æ®æ­¥éª¤æè¿°ç”Ÿæˆ Python ä»£ç 
2. **ä»£ç æ‰§è¡Œ**ï¼šé€šè¿‡ Python MCP æ‰§è¡Œä»£ç 
3. **è¿­ä»£è°ƒè¯•**ï¼šReAct æ¨¡å¼è‡ªåŠ¨ä¿®å¤é”™è¯¯
4. **æ¶ˆæ¯ä¿®å‰ª**ï¼š`modifyCoderfunc` é˜²æ­¢ä¸Šä¸‹æ–‡çˆ†ç‚¸

**å·¥å…·åŠ è½½**ï¼š
```go
// åªåŠ è½½ Python ç›¸å…³å·¥å…·
if strings.HasPrefix(mcpName, "python") {
    coderTools = append(coderTools, ts...)
}
```

**å…¸å‹ä»»åŠ¡**ï¼š
- æ•°æ®å¤„ç†ï¼ˆPandasï¼‰
- å›¾è¡¨ç”Ÿæˆï¼ˆMatplotlibï¼‰
- æ•°å­¦è®¡ç®—ï¼ˆNumPyï¼‰
- æ–‡ä»¶æ“ä½œ

**vs. Researcher**ï¼š
| ç‰¹æ€§ | Researcher | Coder |
|------|-----------|-------|
| å·¥å…· | Web Search | Python MCP |
| è¾“å‡º | æ–‡å­—æ€»ç»“ | ä»£ç ã€å›¾è¡¨ |
| MaxStep | ~20 | 40 |

---

### 3.9 Reporter (æŠ¥å‘Šç”Ÿæˆå™¨)

**èŒè´£**ï¼šæœ€ç»ˆè¾“å‡ºèŠ‚ç‚¹ï¼Œç”Ÿæˆç»“æ„åŒ–æŠ¥å‘Š

**æµç¨‹**ï¼š
```
START â†’ load (æ±‡æ€»æ‰€æœ‰ç»“æœ) 
      â†’ agent (ç”ŸæˆMarkdownæŠ¥å‘Š) 
      â†’ router (è®°å½•+ç»“æŸ)
      â†’ END
```

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
1. **ç»“æœæ±‡æ€»**ï¼šæ”¶é›†æ‰€æœ‰ `step.ExecutionRes`
2. **æŠ¥å‘Šç”Ÿæˆ**ï¼šè°ƒç”¨ LLM ç”Ÿæˆç»“æ„åŒ– Markdown
3. **æ ¼å¼è§„èŒƒ**ï¼šç¡®ä¿åŒ…å«å¿…éœ€éƒ¨åˆ†
4. **æµç¨‹ç»ˆæ­¢**ï¼š`state.Goto = END`

**æŠ¥å‘Šç»“æ„**ï¼š
```markdown
# [æ ‡é¢˜]

## Key Points
- è¦ç‚¹ 1
- è¦ç‚¹ 2

## Overview
æ¦‚è¿°...

## Detailed Analysis
è¯¦ç»†åˆ†æ...

| å¯¹æ¯”é¡¹ | æ•°æ®1 | æ•°æ®2 |
|--------|-------|-------|
| ...    | ...   | ...   |

## Key Citations
- [æ¥æº1](URL)
- [æ¥æº2](URL)
```

**æ ¼å¼è¦æ±‚**ï¼š
- ä¼˜å…ˆä½¿ç”¨ Markdown è¡¨æ ¼
- å¼•ç”¨é›†ä¸­åœ¨æœ«å°¾
- åŒ…å«æ‰€æœ‰å¿…éœ€éƒ¨åˆ†

---

## å››ã€æ ¸å¿ƒè®¾è®¡æœºåˆ¶

### 4.1 çŠ¶æ€ç®¡ç†

**å…±äº«çŠ¶æ€**ï¼š
```go
type State struct {
    // ç”¨æˆ·è¾“å…¥
    Messages []*schema.Message
    
    // è·¯ç”±æ§åˆ¶
    Goto string  // ğŸ‘ˆ æ ¸å¿ƒï¼šå†³å®šä¸‹ä¸€ä¸ª Agent
    
    // è¯­è¨€ä¸é…ç½®
    Locale       string
    MaxStepNum   int
    MaxPlanIterations int
    
    // è®¡åˆ’ä¸æ‰§è¡Œ
    CurrentPlan   *Plan
    PlanIterations int
    
    // èƒŒæ™¯è°ƒæŸ¥
    EnableBackgroundInvestigation  bool
    BackgroundInvestigationResults string
    
    // äººå·¥åé¦ˆ
    AutoAcceptedPlan  bool
    InterruptFeedback string
}
```

**çŠ¶æ€ä¼ é€’**ï¼š
- é€šè¿‡ `context.Context` éšå¼ä¼ é€’
- `compose.ProcessState` ç¡®ä¿å¹¶å‘å®‰å…¨
- æ‰€æœ‰ Agent å…±äº«åŒä¸€ä¸ª State å®ä¾‹

### 4.2 åŠ¨æ€è·¯ç”±æœºåˆ¶

**æ ¸å¿ƒåŸç†**ï¼š
```
Agent å†…éƒ¨:
  router èŠ‚ç‚¹è®¾ç½® â†’ state.Goto = "next_agent"

ä¸»å›¾:
  AddBranch(..., agentHandOff, ...)

agentHandOff:
  è¯»å– state.Goto â†’ è¿”å›ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å

ä¸»å›¾å¼•æ“:
  æ ¹æ®è¿”å›å€¼è·¯ç”±åˆ°å¯¹åº” Agent
```

**ä¼˜åŠ¿**ï¼š
- âœ… çµæ´»ï¼šæ”¯æŒä»»æ„ Agent é—´çš„è·³è½¬
- âœ… å¯æ‰©å±•ï¼šæ–°å¢ Agent æ— éœ€ä¿®æ”¹è·¯ç”±é€»è¾‘
- âœ… å¯è¿½è¸ªï¼šæ‰€æœ‰è·¯ç”±éƒ½ç»è¿‡ `agentHandOff`ï¼Œä¾¿äºæ—¥å¿—

### 4.3 ä¸­æ–­ä¸æ¢å¤

**CheckPoint æœºåˆ¶**ï¼š
```go
// é…ç½®
compose.WithCheckPointStore(model.NewDeerCheckPoint(ctx))

// è§¦å‘ä¸­æ–­
return compose.InterruptAndRerun

// æ¢å¤æ‰§è¡Œ
runnable.Generate(ctx, compose.WithCheckPointID(checkpointID))
```

**å­˜å‚¨å†…å®¹**ï¼š
- å…¨å±€ State
- å„èŠ‚ç‚¹è¾“å…¥
- å½“å‰æ‰§è¡Œä½ç½®

**åº”ç”¨**ï¼š
- Human èŠ‚ç‚¹ç­‰å¾…ç”¨æˆ·åé¦ˆ
- ç³»ç»Ÿå´©æºƒåæ¢å¤
- é•¿æ—¶é—´ä»»åŠ¡çš„åˆ†æ®µæ‰§è¡Œ

### 4.4 å·¥å…·åŠ¨æ€åŠ è½½

**MCP å·¥å…·é›†æˆ**ï¼š
```go
// ä»å¤šä¸ª MCP Server åŠ è½½å·¥å…·
for mcpName, cli := range infra.MCPServer {
    ts, err := mcp.GetTools(ctx, &mcp.Config{Cli: cli})
    
    // æ ¹æ®å‘½åçº¦å®šè¿‡æ»¤
    for _, t := range ts {
        info, _ := t.Info(ctx)
        
        // Researcher: æœç´¢å·¥å…·
        if strings.HasSuffix(info.Name, "search") {
            researchTools = append(researchTools, t)
        }
        
        // Coder: Python å·¥å…·
        if strings.HasPrefix(mcpName, "python") {
            coderTools = append(coderTools, t)
        }
    }
}
```

**ä¼˜åŠ¿**ï¼š
- åŠ¨æ€å‘ç°å·¥å…·
- æ— éœ€ç¡¬ç¼–ç 
- æ˜“äºæ‰©å±•æ–°å·¥å…·

---

## äº”ã€å®Œæ•´æ‰§è¡Œæµç¨‹ç¤ºä¾‹

### åœºæ™¯ï¼šç ”ç©¶ 2025 å¹´ AI è¶‹åŠ¿

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ç”¨æˆ·è¾“å…¥
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"What are the latest AI trends in 2025?"

é…ç½®:
  EnableBackgroundInvestigation = true
  AutoAcceptedPlan = false

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
1ï¸âƒ£ Coordinator
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
load:   æ„é€  Prompt (System + User Message)
agent:  LLM åˆ†æä»»åŠ¡ï¼Œè°ƒç”¨ hand_to_planner
        Arguments: {
          "task_title": "AI Trends 2025",
          "locale": "en-US"
        }
router: state.Locale = "en-US"
        state.Goto = "background_investigator"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2ï¸âƒ£ BackgroundInvestigator
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
search: æŸ¥æ‰¾ Brave Search å·¥å…·
        æ‰§è¡Œ: search("What are the latest AI trends in 2025?")
        ç»“æœ: "Multimodal AI, AGI progress, LLM improvements..."
        ä¿å­˜: state.BackgroundInvestigationResults = "..."
router: state.Goto = "planner"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
3ï¸âƒ£ Planner
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
load:   Prompt åŒ…å«èƒŒæ™¯è°ƒæŸ¥ç»“æœ
agent:  LLM ç”Ÿæˆ Plan:
        {
          "locale": "en-US",
          "has_enough_context": true,
          "title": "AI Trends Research 2025",
          "steps": [
            {
              "title": "Research Multimodal AI",
              "step_type": "research",
              "execution_res": null
            },
            {
              "title": "Research AGI Progress",
              "step_type": "research",
              "execution_res": null
            },
            {
              "title": "Generate Comparison Charts",
              "step_type": "processing",
              "execution_res": null
            }
          ]
        }
router: state.CurrentPlan = {...}
        state.PlanIterations = 1
        has_enough_context = true
        state.Goto = "reporter"  // ğŸ‘ˆ è·³è¿‡ Human

[æ³¨: å¦‚æœ has_enough_context = falseï¼Œä¼šè¿›å…¥ Human èŠ‚ç‚¹]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
4ï¸âƒ£ ResearchTeam (ç¬¬1è½®)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
router: éå† stepsï¼Œæ‰¾åˆ° Step 0 (ExecutionRes == null)
        StepType = "research"
        state.Goto = "researcher"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
5ï¸âƒ£ Researcher (æ‰§è¡Œ Step 0)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
load:   æ³¨å…¥æ­¥éª¤ä¿¡æ¯:
        "Task: Research Multimodal AI
         Description: Investigate multimodal AI..."
         
agent:  ReAct Agent æ‰§è¡Œ:
        Round 1: æ€è€ƒ â†’ search("multimodal AI 2025")
        Round 2: æ€è€ƒ â†’ search("GPT-4V capabilities")
        Round 3: æ€è€ƒ â†’ ç”Ÿæˆæ€»ç»“
        æœ€ç»ˆè¾“å‡º: "Multimodal AI has made significant progress..."
        
router: æ‰¾åˆ° Step 0ï¼Œä¿å­˜ç»“æœ:
        Steps[0].ExecutionRes = &"Multimodal AI has made..."
        state.Goto = "research_team"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
6ï¸âƒ£ ResearchTeam (ç¬¬2è½®)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
router: Step 0 å·²å®Œæˆï¼Œæ‰¾åˆ° Step 1 (ExecutionRes == null)
        StepType = "research"
        state.Goto = "researcher"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
7ï¸âƒ£ Researcher (æ‰§è¡Œ Step 1)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[ç±»ä¼¼ Step 0 çš„æµç¨‹]
router: Steps[1].ExecutionRes = &"AGI progress shows..."
        state.Goto = "research_team"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
8ï¸âƒ£ ResearchTeam (ç¬¬3è½®)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
router: Step 0, 1 å·²å®Œæˆï¼Œæ‰¾åˆ° Step 2
        StepType = "processing"
        state.Goto = "coder"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
9ï¸âƒ£ Coder (æ‰§è¡Œ Step 2)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
load:   æ³¨å…¥æ­¥éª¤ä¿¡æ¯:
        "Task: Generate Comparison Charts
         Description: Create charts comparing AI models..."
         
agent:  ReAct Agent æ‰§è¡Œ:
        Round 1: æ€è€ƒ â†’ python_execute(ç”Ÿæˆå›¾è¡¨ä»£ç )
        Round 2: æ€è€ƒ â†’ python_execute(éªŒè¯æ–‡ä»¶)
        æœ€ç»ˆè¾“å‡º: "Chart generated: comparison.png"
        
router: Steps[2].ExecutionRes = &"Chart generated..."
        state.Goto = "research_team"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”Ÿ ResearchTeam (ç¬¬4è½®)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
router: æ‰€æœ‰æ­¥éª¤å®Œæˆ (ExecutionRes éƒ½éç©º)
        state.Goto = "reporter"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
1ï¸âƒ£1ï¸âƒ£ Reporter
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
load:   æ±‡æ€»æ‰€æœ‰ç»“æœ:
        - Task: AI Trends Research 2025
        - Step 0 ç»“æœ: "Multimodal AI has made..."
        - Step 1 ç»“æœ: "AGI progress shows..."
        - Step 2 ç»“æœ: "Chart generated..."
        
agent:  LLM ç”Ÿæˆç»“æ„åŒ–æŠ¥å‘Š:
        # AI Trends Research 2025
        
        ## Key Points
        - Multimodal AI is leading innovation
        - AGI shows significant progress
        - Performance comparison available
        
        ## Overview
        The AI landscape in 2025...
        
        ## Detailed Analysis
        ### Multimodal AI
        ...
        
        | Model | Score | Features |
        |-------|-------|----------|
        | GPT-4 | 95    | Vision   |
        | ...   | ...   | ...      |
        
        ## Key Citations
        - [OpenAI GPT-4](https://...)
        
router: è®°å½•æŠ¥å‘Š
        state.Goto = "END"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
æœ€ç»ˆè¾“å‡º
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
å®Œæ•´çš„ Markdown ç ”ç©¶æŠ¥å‘Š
```

---

## å…­ã€å…³é”®è®¾è®¡ç‰¹ç‚¹

### 6.1 æ¨¡å—åŒ–è®¾è®¡

**æ¯ä¸ª Agent éƒ½æ˜¯ç‹¬ç«‹å­å›¾**ï¼š
- âœ… å¯ç‹¬ç«‹å¼€å‘å’Œæµ‹è¯•
- âœ… èŒè´£å•ä¸€ï¼Œæ˜“äºç»´æŠ¤
- âœ… ç»Ÿä¸€çš„ä¸‰èŠ‚ç‚¹ç»“æ„ï¼ˆload â†’ agent â†’ routerï¼‰

### 6.2 çŠ¶æ€é©±åŠ¨

**æ‰€æœ‰è·¯ç”±å†³ç­–éƒ½åŸºäºå…±äº«çŠ¶æ€**ï¼š
```go
// ä¸æ˜¯ç¡¬ç¼–ç çš„æµç¨‹
Coordinator â†’ Planner â†’ ResearchTeam â†’ Reporter

// è€Œæ˜¯åŠ¨æ€çš„çŠ¶æ€é©±åŠ¨
æ¯ä¸ª Agent: state.Goto = "next_agent"
ä¸»å›¾: æ ¹æ® state.Goto è·¯ç”±
```

**ä¼˜åŠ¿**ï¼š
- çµæ´»çš„æµç¨‹æ§åˆ¶
- æ”¯æŒå¾ªç¯å’Œæ¡ä»¶è·³è½¬
- æ˜“äºè°ƒè¯•å’Œè¿½è¸ª

### 6.3 å·¥å…·ä¸“ç”¨åŒ–

**ä¸åŒ Agent ä½¿ç”¨ä¸åŒå·¥å…·é›†**ï¼š
- Researcher â†’ Web Search
- Coder â†’ Python MCP
- BackgroundInvestigator â†’ Search

**é¿å…å·¥å…·æ··ä¹±**ï¼š
- LLM é€‰æ‹©å·¥å…·æ›´å‡†ç¡®
- å‡å°‘æ— å…³å·¥å…·å¹²æ‰°
- æé«˜æ‰§è¡Œæ•ˆç‡

### 6.4 äººæœºåä½œ

**äººåœ¨å›è·¯ï¼ˆHuman-in-the-Loopï¼‰**ï¼š
- å…³é”®å†³ç­–ç‚¹äººå·¥ä»‹å…¥
- æ”¯æŒè‡ªåŠ¨å’Œæ‰‹åŠ¨æ¨¡å¼
- åŸºäº CheckPoint çš„ä¸­æ–­æ¢å¤

### 6.5 å¤šè¯­è¨€æ”¯æŒ

**å…¨å±€è¯­è¨€ä¸€è‡´æ€§**ï¼š
```go
Coordinator: æ£€æµ‹ locale = "zh-CN"
æ‰€æœ‰ Agent: ä½¿ç”¨ state.Locale ç”Ÿæˆå¯¹åº”è¯­è¨€çš„è¾“å‡º
```

---

## ä¸ƒã€æ€§èƒ½ä¸å¯æ‰©å±•æ€§

### 7.1 æ€§èƒ½è€ƒè™‘

**æ½œåœ¨ç“¶é¢ˆ**ï¼š
- çŠ¶æ€é”ç«äº‰ï¼ˆæ‰€æœ‰ Agent é€šè¿‡ `ProcessState` è®¿é—®ï¼‰
- é•¿ä¸Šä¸‹æ–‡å¤„ç†ï¼ˆReporter æ±‡æ€»æ‰€æœ‰ç»“æœï¼‰
- å·¥å…·è°ƒç”¨å»¶è¿Ÿï¼ˆå¤–éƒ¨ API ä¾èµ–ï¼‰

**ä¼˜åŒ–ç­–ç•¥**ï¼š
- æ¶ˆæ¯ä¿®å‰ªï¼ˆ`modifyCoderfunc`ï¼‰
- ç¼“å­˜ Prompt æ¨¡æ¿
- å¹¶è¡Œæ‰§è¡Œç‹¬ç«‹æ­¥éª¤ï¼ˆæœªæ¥ä¼˜åŒ–ï¼‰

### 7.2 æ‰©å±•æ€§

**æ–°å¢ Agent çš„æ­¥éª¤**ï¼š
1. åˆ›å»ºå­å›¾æ„é€ å‡½æ•° `NewMyAgent[I, O any](ctx)`
2. åœ¨ `Builder` ä¸­åˆå§‹åŒ–: `myAgentGraph := NewMyAgent[I, O](ctx)`
3. æ·»åŠ åˆ° `outMap`: `consts.MyAgent: true`
4. æ·»åŠ èŠ‚ç‚¹å’Œåˆ†æ”¯:
   ```go
   g.AddGraphNode(consts.MyAgent, myAgentGraph, ...)
   g.AddBranch(consts.MyAgent, compose.NewGraphBranch(agentHandOff, outMap))
   ```

**æ— éœ€ä¿®æ”¹**ï¼š
- `agentHandOff` å‡½æ•°ï¼ˆé€šç”¨è·¯ç”±ï¼‰
- å…¶ä»– Agent çš„ä»£ç 

---

## å…«ã€ç›‘æ§ä¸è°ƒè¯•

### 8.1 å…³é”®ç›‘æ§æŒ‡æ ‡

| Agent | å…³é”®æŒ‡æ ‡ |
|-------|----------|
| **Coordinator** | hand_to_planner è°ƒç”¨æˆåŠŸç‡ã€locale æ£€æµ‹å‡†ç¡®ç‡ |
| **Planner** | JSON è§£ææˆåŠŸç‡ã€has_enough_context=true æ¯”ä¾‹ |
| **Human** | ä¸­æ–­ç‡ã€å¹³å‡ç­‰å¾…æ—¶é—´ã€ç¼–è¾‘ç‡ |
| **ResearchTeam** | ResearchTeam å¾ªç¯æ¬¡æ•°ã€å¹³å‡æ­¥éª¤æ•° |
| **Researcher** | å¹³å‡è½®æ¬¡ã€å·¥å…·è°ƒç”¨æˆåŠŸç‡ |
| **Coder** | ä»£ç æ‰§è¡ŒæˆåŠŸç‡ã€å¹³å‡æ‰§è¡Œæ—¶é—´ |
| **Reporter** | æŠ¥å‘Šç”ŸæˆæˆåŠŸç‡ã€æ ¼å¼åˆè§„ç‡ |

### 8.2 æ—¥å¿—è¿½è¸ª

**å…³é”®æ—¥å¿—ç‚¹**ï¼š
```go
// agentHandOff
ilog.EventInfo(ctx, "agent_hand_off", "input", input, "next", next)

// å„ Agent çš„ router
ilog.EventInfo(ctx, "xxx_end", "plan", state.CurrentPlan)
```

**è°ƒè¯•æµç¨‹**ï¼š
1. æŸ¥çœ‹ `agent_hand_off` æ—¥å¿—è¿½è¸ªè·¯ç”±é“¾
2. æ£€æŸ¥å„ Agent çš„è¾“å…¥è¾“å‡º
3. åˆ†æçŠ¶æ€å˜åŒ–ï¼ˆ`state.Goto`, `state.CurrentPlan`ï¼‰

---

## ä¹ã€ä½¿ç”¨åœºæ™¯

### 9.1 é€‚ç”¨åœºæ™¯

âœ… **ç ”ç©¶å‹ä»»åŠ¡**
- å¸‚åœºè°ƒç ”æŠ¥å‘Š
- æŠ€æœ¯è¶‹åŠ¿åˆ†æ
- ç«å“å¯¹æ¯”åˆ†æ

âœ… **æ•°æ®å¤„ç† + åˆ†æ**
- æ•°æ®å¯è§†åŒ–
- ç»Ÿè®¡åˆ†ææŠ¥å‘Š
- è‡ªåŠ¨åŒ–æ•°æ®å¤„ç†

âœ… **çŸ¥è¯†æ•´åˆ**
- å¤šæºä¿¡æ¯æ±‡æ€»
- æ–‡çŒ®ç»¼è¿°
- ä¸»é¢˜æ·±åº¦åˆ†æ

### 9.2 ä¸é€‚ç”¨åœºæ™¯

âŒ **å®æ—¶å¯¹è¯**
- ç³»ç»Ÿè®¾è®¡ä¸ºä»»åŠ¡å‹ï¼Œä¸é€‚åˆé—²èŠ
- å¤šæ­¥éª¤æ‰§è¡Œï¼Œå»¶è¿Ÿè¾ƒé«˜

âŒ **ç®€å•é—®ç­”**
- è¿‡äºå¤æ‚ï¼Œæ€é¸¡ç”¨ç‰›åˆ€
- å»ºè®®ç›´æ¥è°ƒç”¨å•ä¸ª LLM

âŒ **åˆ›æ„ç”Ÿæˆ**
- æµç¨‹å›ºå®šï¼Œé™åˆ¶åˆ›é€ æ€§
- æ›´é€‚åˆç»“æ„åŒ–ä»»åŠ¡

---

## åã€æ€»ç»“

### æ ¸å¿ƒä»·å€¼

Deer-Go æ˜¯ä¸€ä¸ª**ç”Ÿäº§çº§çš„å¤šæ™ºèƒ½ä½“ç ”ç©¶ç³»ç»Ÿ**ï¼Œå®ç°äº†ï¼š

1. **æ™ºèƒ½ä»»åŠ¡åˆ†è§£**ï¼šPlanner å°†å¤æ‚ä»»åŠ¡æ‹†åˆ†ä¸ºå¯æ‰§è¡Œæ­¥éª¤
2. **ä¸“ä¸šåŒ–æ‰§è¡Œ**ï¼šResearcherï¼ˆç ”ç©¶ï¼‰+ Coderï¼ˆå¤„ç†ï¼‰åˆ†å·¥åä½œ
3. **è´¨é‡ä¿éšœ**ï¼šHuman èŠ‚ç‚¹çš„äººå·¥æŠŠå…³æœºåˆ¶
4. **çµæ´»è·¯ç”±**ï¼šçŠ¶æ€é©±åŠ¨çš„åŠ¨æ€æµç¨‹æ§åˆ¶
5. **å·¥å…·é›†æˆ**ï¼šMCP å·¥å…·çš„åŠ¨æ€åŠ è½½å’Œä¸“ç”¨åŒ–
6. **å¯é æ€§**ï¼šCheckPoint æœºåˆ¶çš„ä¸­æ–­ä¸æ¢å¤

### è®¾è®¡äº®ç‚¹

- âœ… **8 ä¸ªä¸“ä¸š Agent**ï¼šå„å¸å…¶èŒï¼Œæ¨¡å—åŒ–è®¾è®¡
- âœ… **åŠ¨æ€è·¯ç”±**ï¼š`agentHandOff` + `state.Goto` å®ç°çµæ´»æµç¨‹
- âœ… **çŠ¶æ€å…±äº«**ï¼šé€šè¿‡ `context.Context` ä¼ é€’å…¨å±€çŠ¶æ€
- âœ… **äººæœºåä½œ**ï¼šHuman-in-the-Loop æœºåˆ¶
- âœ… **å·¥å…·ä¸“ç”¨åŒ–**ï¼šä¸åŒ Agent ä½¿ç”¨ä¸åŒå·¥å…·é›†
- âœ… **å¤šè¯­è¨€æ”¯æŒ**ï¼šè‡ªåŠ¨æ£€æµ‹å¹¶é€‚é…

### æŠ€æœ¯æ ˆ

- **æ¡†æ¶**ï¼šEino (Compose Graph)
- **LLM**ï¼šOpenAI/Anthropic/Google (å¯é…ç½®)
- **å·¥å…·åè®®**ï¼šMCP (Model Context Protocol)
- **è¯­è¨€**ï¼šGo
- **ç‰¹æ€§**ï¼šReActã€CheckPointã€æµå¼è¾“å‡º

---

## ç›¸å…³æ–‡æ¡£

- `builderé€»è¾‘åˆ†æ.md` - å›¾æ„å»ºå™¨è¯¦è§£
- `coordinatoré€»è¾‘åˆ†æ.md` - åè°ƒå™¨è¯¦è§£
- `planneré€»è¾‘åˆ†æ.md` - è§„åˆ’å¸ˆè¯¦è§£
- `research_teamé€»è¾‘åˆ†æ.md` - è°ƒåº¦å™¨è¯¦è§£
- `Researcheræ‰§è¡Œé€»è¾‘åˆ†æ.md` - ç ”ç©¶å‘˜è¯¦è§£
- `coderé€»è¾‘åˆ†æ.md` - ä»£ç æ‰§è¡Œå™¨è¯¦è§£
- `reporteré€»è¾‘åˆ†æ.md` - æŠ¥å‘Šç”Ÿæˆå™¨è¯¦è§£
- `investigatoré€»è¾‘åˆ†æ.md` - èƒŒæ™¯è°ƒæŸ¥å‘˜è¯¦è§£
- `human_feedbacké€»è¾‘åˆ†æ.md` - äººå·¥åé¦ˆè¯¦è§£

---

**æœ€åæ›´æ–°**: 2025-10-22

**ç‰ˆæœ¬**: v1.0

**ä½œè€…**: Eino Deer-Go Team

